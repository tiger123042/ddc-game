<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÄ‡∏Å‡∏°‡∏à‡∏µ‡∏ö‡∏°‡∏≤‡∏¢‡∏î‡πå - ‡∏à‡∏±‡∏î‡∏´‡∏°‡∏π‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ DDC</title>
  <style>
    body {
      font-family: 'Kanit', sans-serif;
      background-color: #f0f8ff;
      margin: 0;
      padding: 0;
      background-image: url("https://cdn.pixabay.com/photo/2020/04/12/16/04/library-5036901_1280.jpg");
      background-size: cover;
    }
    #gameContainer {
      max-width: 700px;
      margin: 30px auto;
      background-color: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
    }
    h1 {
      text-align: center;
      color: #d63384;
    }
    #dialogBox {
      margin-bottom: 20px;
      font-size: 1.1em;
    }
    .choice-btn {
      display: block;
      margin: 8px 0;
      padding: 10px;
      width: 100%;
      font-size: 1em;
      background-color: #ff85a2;
      border: none;
      border-radius: 10px;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    .choice-btn:hover {
      background-color: #e25580;
    }
    .speaker {
      font-weight: bold;
      color: #ff1493;
    }
  </style>
</head>
<body>

<div id="gameContainer">
  <h1>‡∏à‡∏µ‡∏ö‡∏°‡∏≤‡∏¢‡∏î‡πå üíñ ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î</h1>
  <div id="dialogBox"></div>
  <div id="choices"></div>
</div>

<script>
  const stages = [
    {
      bg: "https://cdn.pixabay.com/photo/2023/11/12/08/47/woman-8382546_1280.jpg",
      dialog: [
        { speaker: "‡∏°‡∏≤‡∏¢‡∏î‡πå", text: "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞! ‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏≠‡πà‡∏¢? üòä" }
      ],
      input: true
    },
    {
      bg: "https://cdn.pixabay.com/photo/2017/08/06/00/43/books-2581596_960_720.jpg",
      dialog: [
        { speaker: "‡∏°‡∏≤‡∏¢‡∏î‡πå", text: "‡∏°‡∏≤‡∏¢‡∏î‡πå‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ DDC ‡∏ô‡∏∞ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏°‡∏±‡πâ‡∏¢?" }
      ],
      choices: [
        { text: "‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß!", score: 1 },
        { text: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à", score: 0 }
      ]
    },
    {
      bg: "https://cdn.pixabay.com/photo/2015/09/05/21/51/library-925545_1280.jpg",
      dialog: [
        { speaker: "‡∏°‡∏≤‡∏¢‡∏î‡πå", text: "000 ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏¥‡∏ß‡∏≠‡∏µ‡πâ?" }
      ],
      choices: [
        { text: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ", score: 1 },
        { text: "‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ", score: 0 },
        { text: "‡∏ß‡∏£‡∏£‡∏ì‡∏Å‡∏£‡∏£‡∏°", score: 0 }
      ]
    },
    {
      bg: "https://cdn.pixabay.com/photo/2017/08/01/08/29/library-2569989_1280.jpg",
      dialog: [
        { speaker: "‡∏°‡∏≤‡∏¢‡∏î‡πå", text: "800 ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏ô‡∏∞?" }
      ],
      choices: [
        { text: "‡∏†‡∏≤‡∏©‡∏≤", score: 0 },
        { text: "‡∏ß‡∏£‡∏£‡∏ì‡∏Å‡∏£‡∏£‡∏°", score: 1 },
        { text: "‡∏®‡∏≤‡∏™‡∏ô‡∏≤", score: 0 }
      ]
    }
  ];

  let currentStage = 0;
  let dialogIndex = 0;
  let playerName = "";
  let score = 0;

  const dialogBox = document.getElementById("dialogBox");
  const choicesDiv = document.getElementById("choices");

  function showDialog() {
    const stage = stages[currentStage];
    if (dialogIndex < stage.dialog.length) {
      const d = stage.dialog[dialogIndex];
      dialogBox.innerHTML = `<div class="speaker">${d.speaker}:</div><div>${d.text}</div>`;
      dialogIndex++;
    } else {
      if (stage.input) {
        dialogBox.innerHTML += `
          <div><input id="nameInput" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" style="width: 100%; padding: 8px; margin-top: 10px;"></div>
          <button class="choice-btn" onclick="saveName()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ä‡∏∑‡πà‡∏≠</button>
        `;
      } else if (stage.choices) {
        showChoices(stage.choices);
      } else {
        nextStage();
      }
    }
  }

  function saveName() {
    const input = document.getElementById("nameInput");
    playerName = input.value.trim();
    if (playerName !== "") {
      nextStage();
    } else {
      alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞");
    }
  }

  function showChoices(choices) {
    choicesDiv.innerHTML = "";
    choices.forEach(choice => {
      const btn = document.createElement("button");
      btn.className = "choice-btn";
      btn.textContent = choice.text;
      btn.onclick = () => {
        score += choice.score;
        nextStage();
      };
      choicesDiv.appendChild(btn);
    });
  }

  function clearChoices() {
    choicesDiv.innerHTML = "";
  }

  function setBackground(url) {
    document.body.style.backgroundImage = `url('${url}')`;
  }

  function nextStage() {
    currentStage++;
    dialogIndex = 0;
    if (currentStage >= stages.length) {
      dialogBox.innerHTML = 
        `<div class="speaker">‡∏°‡∏≤‡∏¢‡∏î‡πå:</div>
        <div>üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢, <strong>${playerName}</strong>! ‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô <strong>${score}</strong> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞~ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏•‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô üíñ</div>`;
      clearChoices();
      setBackground("https://cdn.pixabay.com/photo/2017/08/06/00/43/books-2581596_960_720.jpg");

      // ‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet
      fetch("https://script.google.com/macros/s/AKfycbyE6A6wP3Xh5J4GPaoVYVkDmMvo2UHENIHBIWBFUYqOBv77aWTcx1fDfFbsyGQIHU-7/exec", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          name: playerName,
          score: score
        })
      })
      .then(res => res.json())
      .then(data => console.log("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:", data))
      .catch(err => console.error("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:", err));

    } else {
      setBackground(stages[currentStage].bg);
      showDialog();
    }
  }

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
  setBackground(stages[0].bg);
  showDialog();
</script>
</body>
</html>
