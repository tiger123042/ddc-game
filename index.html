<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏î‡∏´‡∏°‡∏π‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ DDC</title>
  <style>
    body { font-family: 'Prompt', sans-serif; padding: 20px; background: #f9f9f9; text-align: center; }
    h1 { font-size: 2rem; color: #3b5998; }
    .section { margin-top: 20px; }
    input, button { padding: 10px; font-size: 16px; margin: 5px; }
    .leaderboard { background: #fff; padding: 10px; margin-top: 20px; border: 1px solid #ccc; border-radius: 10px; }
    .leaderboard h2 { font-size: 1.2rem; }
    .leaderboard ul { list-style: none; padding: 0; }
    .leaderboard li { padding: 5px; border-bottom: 1px dashed #ddd; }
  </style>
</head>
<body>

<h1>üìö ‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏î‡∏´‡∏°‡∏π‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ DDC</h1>

<div class="section">
  <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô: </label>
  <input type="text" id="playerName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" />
  <button onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô</button>
</div>

<div class="section" id="gameSection" style="display:none;">
  <p id="questionText">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏à‡∏∞‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ</p>
  <button onclick="answer(true)">‚úî ‡∏ñ‡∏π‡∏Å</button>
  <button onclick="answer(false)">‚ùå ‡∏ú‡∏¥‡∏î</button>
</div>

<div class="section leaderboard">
  <h2>üèÜ Leaderboard</h2>
  <ul id="leaderboardList">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</ul>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbzcWdBh8nEBtgFL2I-IKqFO3KTXg6GZKrsDoa6Va3avG4T7l0jekQCiAD_DzCyAKIFQYg/exec";

let score = 0;
let round = 0;
const questions = [
  { text: "000 ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ", answer: true },
  { text: "500 ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏†‡∏≤‡∏©‡∏≤", answer: false },
  { text: "300 ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", answer: true }
];

function startGame() {
  const name = document.getElementById("playerName").value.trim();
  if (name === "") {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°");
    return;
  }
  score = 0;
  round = 0;
  document.getElementById("gameSection").style.display = "block";
  nextQuestion();
}

function nextQuestion() {
  if (round < questions.length) {
    document.getElementById("questionText").innerText = questions[round].text;
  } else {
    document.getElementById("gameSection").innerHTML = `<h2>‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ${score} / ${questions.length}</h2>`;
    submitScore();
  }
}

function answer(isCorrect) {
  if (questions[round].answer === isCorrect) {
    score++;
  }
  round++;
  nextQuestion();
}

function submitScore() {
  const name = document.getElementById("playerName").value.trim();
  fetch(`${scriptURL}?action=submit&name=${encodeURIComponent(name)}&score=${score}`)
    .then(res => res.text())
    .then(txt => {
      console.log("‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:", txt);
      loadLeaderboard();
    })
    .catch(err => {
      console.error("‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:", err);
    });
}

function loadLeaderboard() {
  fetch(`${scriptURL}?action=scorelist`)
    .then(res => res.json())
    .then(data => {
      const ul = document.getElementById("leaderboardList");
      ul.innerHTML = "";
      data.forEach(row => {
        const li = document.createElement("li");
        li.textContent = `${row.name}: ${row.score} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`;
        ul.appendChild(li);
      });
    })
    .catch(err => {
      console.error("‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:", err);
      document.getElementById("leaderboardList").innerHTML = "‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
    });
}

// ‡πÇ‡∏´‡∏•‡∏î leaderboard ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏ô
loadLeaderboard();
</script>

</body>
</html>
