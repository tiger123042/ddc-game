<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏î‡∏´‡∏°‡∏π‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</title>
  <style>
    body {
      font-family: 'Kanit', sans-serif;
      text-align: center;
      padding: 20px;
      background: #f5f8ff;
    }
    h1 {
      color: #1a237e;
    }
    input, button {
      padding: 10px;
      font-size: 18px;
      margin: 10px;
    }
    #leaderboard {
      margin-top: 40px;
    }
    table {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      border-collapse: collapse;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
    }
    th {
      background: #3949ab;
      color: white;
    }
    tr:nth-child(even) {
      background: #f0f0f0;
    }
  </style>
</head>
<body>
  <h1>üìö ‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏î‡∏´‡∏°‡∏π‡πà‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ (DDC)</h1>
  <div id="game">
    <input type="text" id="nameInput" placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" />
    <br>
    <button onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
    <div id="questionBox" style="margin-top: 20px;"></div>
    <div id="scoreBox" style="font-size: 24px; margin-top: 20px;"></div>
  </div>

  <div id="leaderboard">
    <h2>üèÜ ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h2>
    <table id="scoreTable">
      <thead>
        <tr><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th><th>‡πÄ‡∏ß‡∏•‡∏≤</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwUYjClplRkxbzwvTpHWZeZTQorUAbLrFPP8uBKTEeWDzQtTVVY5OU5M8-gHsfbnD48/exec";

    let score = 0;
    let current = 0;
    const questions = [
      { q: "000 ‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ" },
      { q: "100 ‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡∏õ‡∏£‡∏±‡∏ä‡∏ç‡∏≤" },
      { q: "300 ‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∞‡πÑ‡∏£?", a: "‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå" },
    ];

    function startGame() {
      score = 0;
      current = 0;
      document.getElementById("scoreBox").innerText = "";
      showQuestion();
    }

    function showQuestion() {
      if (current < questions.length) {
        const q = questions[current];
        document.getElementById("questionBox").innerHTML = `
          <p style="font-size:20px;">${q.q}</p>
          <input type="text" id="answerInput" placeholder="‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" />
          <br>
          <button onclick="submitAnswer()">‡∏ï‡∏≠‡∏ö</button>
        `;
      } else {
        finishGame();
      }
    }

    function submitAnswer() {
      const userAns = document.getElementById("answerInput").value.trim();
      if (userAns === questions[current].a) {
        score++;
      }
      current++;
      showQuestion();
    }

    function finishGame() {
      const name = document.getElementById("nameInput").value.trim();
      document.getElementById("questionBox").innerHTML = '';
      document.getElementById("scoreBox").innerText = `‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ ${score} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`;

      if (name !== "") {
        // ‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏õ Apps Script
        fetch(SCRIPT_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ name: name, score: score })
        })
        .then(res => res.json())
        .then(data => {
          console.log("‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß", data);
          loadScores();
        })
        .catch(err => {
          console.error("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô", err);
        });
      }
    }

    function loadScores() {
      fetch(SCRIPT_URL + "?action=scorelist")
        .then(res => res.json())
        .then(data => {
          const tbody = document.querySelector("#scoreTable tbody");
          tbody.innerHTML = "";
          data.forEach(row => {
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${row.name}</td><td>${row.score}</td><td>${new Date(row.timestamp).toLocaleString()}</td>`;
            tbody.appendChild(tr);
          });
        });
    }

    loadScores(); // ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
  </script>
</body>
</html>
